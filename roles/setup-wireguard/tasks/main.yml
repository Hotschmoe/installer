---
# Sets up wireguard to run at boot with a given config

- name: Template wireguard config
  template:
    src: wgExit.conf.j2
    dest: /etc/wireguard/wgExit.conf
  become: true

- name: Fail on nonsystemd systems
  fail:
    msg: "No support for non systemd services, please add support for your init system!"
  when: ansible_service_mgr is not systemd

- name: Enable Wireguard service
  service:
    name: wg-quick@wgExit
    state: restarted
    enabled: true
  become: true
  when: ansible_service_mgr is systemd
